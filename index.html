<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Code Alchemist Chat</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');

    /* Reset */
    * {
      box-sizing: border-box;
    }
    body, html {
      margin:0; padding:0; height: 100%;
      background: #000000;
      font-family: 'Share Tech Mono', monospace;
      color: #0f0;
      display: flex;
      justify-content: center;
      align-items: center;
      user-select: none;
    }

    #chat-container {
      width: 100%;
      max-width: 600px;
      height: 90vh;
      background: linear-gradient(135deg, #001a00, #003300);
      border: 2px solid #00ff00;
      border-radius: 12px;
      display: flex;
      flex-direction: column;
      box-shadow:
        0 0 10px #00ff00,
        inset 0 0 20px #007700;
    }

    header {
      padding: 1rem;
      font-size: 1.8rem;
      font-weight: bold;
      text-align: center;
      color: #00ff00;
      text-shadow:
        0 0 10px #00ff00;
      border-bottom: 1px solid #00ff00;
      user-select: text;
      letter-spacing: 0.1em;
      background: #002200;
    }

    #chat {
      flex-grow: 1;
      padding: 1rem 1.5rem;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 0.7rem;
      scrollbar-width: thin;
      scrollbar-color: #00ff00 transparent;
      background:
        repeating-linear-gradient(
          0deg,
          rgba(0,255,0,0.04),
          rgba(0,255,0,0.04) 2px,
          transparent 3px,
          transparent 6px
        );
    }
    #chat::-webkit-scrollbar {
      width: 8px;
    }
    #chat::-webkit-scrollbar-track {
      background: transparent;
    }
    #chat::-webkit-scrollbar-thumb {
      background: #00ff00;
      border-radius: 4px;
    }

    .msg {
      max-width: 70%;
      padding: 0.6rem 1rem;
      border-radius: 20px;
      font-size: 1.1rem;
      line-height: 1.3;
      position: relative;
      user-select: text;
      word-wrap: break-word;
      box-shadow: 0 0 8px #00ff00aa;
      animation: fadeInUp 0.3s ease forwards;
    }

    .msg.user {
      align-self: flex-end;
      background: linear-gradient(145deg, #00ff66, #009933);
      color: #002200;
      border-bottom-right-radius: 4px;
      box-shadow:
        0 0 15px #00ff66,
        inset 0 0 10px #00ff66;
    }

    .msg.bot {
      align-self: flex-start;
      background: linear-gradient(145deg, #003300, #006600);
      color: #00ff00;
      border-bottom-left-radius: 4px;
      box-shadow:
        0 0 15px #00ff00,
        inset 0 0 10px #00ff00;
    }

    .msg.user::after,
    .msg.bot::after {
      content: "";
      position: absolute;
      bottom: 0;
      width: 0; 
      height: 0;
      border-style: solid;
    }
    .msg.user::after {
      right: -10px;
      border-width: 10px 0 0 10px;
      border-color: transparent transparent transparent #00ff66;
      filter: drop-shadow(0 0 3px #00ff66);
    }
    .msg.bot::after {
      left: -10px;
      border-width: 10px 10px 0 0;
      border-color: transparent #003300 transparent transparent;
      filter: drop-shadow(0 0 3px #00ff00);
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(15px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    #input-area {
      display: flex;
      border-top: 1px solid #00ff00;
      background: #001a00;
      padding: 1rem 1.5rem;
      gap: 1rem;
    }

    #userInput {
      flex-grow: 1;
      background: transparent;
      border: 2px solid #00ff00;
      border-radius: 25px;
      padding: 0.7rem 1.2rem;
      font-family: 'Share Tech Mono', monospace;
      font-size: 1.2rem;
      color: #00ff00;
      outline: none;
      letter-spacing: 0.05em;
      transition: border-color 0.3s ease;
      user-select: text;
    }
    #userInput::placeholder {
      color: #055005;
      font-style: italic;
      opacity: 0.6;
    }
    #userInput:focus {
      border-color: #00ff99;
      box-shadow: 0 0 10px #00ff99;
    }

    #sendBtn {
      background: #00ff66;
      border: none;
      border-radius: 25px;
      color: #002200;
      font-weight: 700;
      font-size: 1.2rem;
      padding: 0 1.8rem;
      cursor: pointer;
      user-select: none;
      box-shadow: 0 0 15px #00ff66;
      transition: background-color 0.3s ease;
    }
    #sendBtn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
      box-shadow: none;
    }
    #sendBtn:hover:not(:disabled) {
      background-color: #00ff99;
      box-shadow: 0 0 20px #00ff99;
    }

    /* Typing indicator */
    #typing {
      padding-left: 1.5rem;
      font-style: italic;
      color: #00ff00cc;
      min-height: 1.4rem;
      user-select: none;
      font-size: 1rem;
      text-shadow: 0 0 8px #00ff00cc;
    }

    /* Responsive */
    @media (max-width: 480px) {
      #chat-container {
        height: 95vh;
        max-width: 100vw;
        border-radius: 0;
      }
      #userInput {
        font-size: 1rem;
        padding: 0.5rem 1rem;
      }
      #sendBtn {
        font-size: 1rem;
        padding: 0 1rem;
      }
    }
  </style>
</head>
<body>
  <div id="chat-container" role="main" aria-label="Code Alchemist chat">
    <header>Code Alchemist Chat</header>
    <div id="chat" aria-live="polite" aria-atomic="false" tabindex="0"></div>
    <div id="typing" aria-live="assertive" aria-atomic="true"></div>
    <form id="input-area" onsubmit="return false;" aria-label="Send message form">
      <input
        id="userInput"
        type="text"
        autocomplete="off"
        placeholder="Type your command..."
        aria-label="User input"
        required
        spellcheck="false"
      />
      <button id="sendBtn" disabled aria-disabled="true" aria-label="Send message button">SEND</button>
    </form>
  </div>

  <script>
    const chat = document.getElementById('chat');
    const input = document.getElementById('userInput');
    const sendBtn = document.getElementById('sendBtn');
    const typing = document.getElementById('typing');

    input.addEventListener('input', () => {
      const val = input.value.trim();
      sendBtn.disabled = val.length === 0;
      sendBtn.setAttribute('aria-disabled', val.length === 0 ? 'true' : 'false');
    });

    function scrollBottom() {
      chat.scrollTo({top: chat.scrollHeight, behavior: 'smooth'});
    }

    // Typewriter effect for AI response
    function typeEffect(element, text, speed = 30, cb) {
      let i = 0;
      element.textContent = '';
      function type() {
        if(i < text.length){
          element.textContent += text.charAt(i);
          i++;
          scrollBottom();
          setTimeout(type, speed);
        } else if(cb) cb();
      }
      type();
    }

    function appendMessage(text, sender){
      const msg = document.createElement('div');
      msg.classList.add('msg', sender);
      msg.textContent = text;
      chat.appendChild(msg);
      scrollBottom();
      return msg;
    }

    function getAIResponse(input) {
      const msg = input.toLowerCase();
      if(msg.includes('hello') || msg.includes('hi')){
        return "Greetings, seeker of the Code Alchemist.";
      } else if(msg.includes('help')){
        return "Ask me about code, encryption, or the secrets of the digital forge.";
      } else if(msg.includes('who are you')){
        return "I am the digital alchemist, weaving code into magic.";
      } else if(msg.includes('magic')){
        return "True magic lies in the mastery of algorithms and logic.";
      } else if(msg.includes('secret')){
        return "The secret to code alchemy? Persistence and curiosity.";
      } else {
        return "The forge contemplates your words...";
      }
    }

    async function sendMessage(){
      const userText = input.value.trim();
      if(!userText) return;

      appendMessage(userText, 'user');
      input.value = '';
      sendBtn.disabled = true;
      sendBtn.setAttribute('aria-disabled', 'true');

      typing.textContent = 'Code Alchemist is typing...';

      // Simulate delay for typing
      await new Promise(r => setTimeout(r, 1000));

      typing.textContent = '';
      const botMsg = appendMessage('', 'bot');
      typeEffect(botMsg, getAIResponse(userText), 25);
    }

    sendBtn.addEventListener('click', sendMessage);
    input.addEventListener('keydown', e => {
      if(e.key === 'Enter' && !sendBtn.disabled){
        sendMessage();
      }
    });

  </script>
</body>
</html>